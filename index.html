<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Formation à l'ECG - La Défense Belge</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            margin: 0;
        }
        h1, h2 {
            color: #333;
        }
        form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }
        label {
            display: block;
            margin-top: 12px;
            font-weight: bold;
        }
        input[type="text"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        #personal-info {
            display: flex;
            gap: 20px;
        }
        #personal-info div {
            flex: 1;
        }
        #container {
            display: flex;
            margin-top: 25px;
            gap: 25px;
        }
        #electrodes {
            width: 140px;
            background: #f0f0f0;
            padding: 12px;
            border-radius: 6px;
            flex-shrink: 0;
        }
        .electrode {
            color: white;
            margin: 8px 0;
            text-align: center;
            cursor: grab;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            line-height: 24px;
            font-size: 10px;
            font-weight: bold;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #ra { background: red; }
        #la { background: yellow; color: black; }
        #rl { background: black; }
        #ll { background: green; }
        #v1 { background: red; }
        #v2 { background: yellow; color: black; }
        #v3 { background: green; }
        #v4 { background: brown; }
        #v5 { background: black; }
        #v6 { background: purple; }
        #v7 { background: orange; }
        #v8 { background: white; color: black; }
        #v9 { background: grey; }
        #mannequin-container {
            position: relative;
            border: 1px solid #ccc;
            border-radius: 6px;
            overflow: hidden;
            flex: 1;
            max-width: 1000px;
        }
        #mannequin {
            width: 100%;
            height: auto;
            display: block;
        }
        button {
            background: #28a745;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            margin-top: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #218838;
        }
    </style>
</head>
<body>

    <h1>Formation à l'ECG (Électrocardiogramme) - La Défense Belge</h1>

    <form id="ecgForm">
        <h2>Informations personnelles</h2>
        <div id="personal-info">
            <div>
                <label>Nom</label>
                <input type="text" name="nom" required>
            </div>
            <div>
                <label>Prénom</label>
                <input type="text" name="prenom" required>
            </div>
        </div>

        <h2>Questions théoriques sur les ondes ECG</h2>
        
        <label>1. Que représente l'onde P ?</label>
        <input type="text" name="q1" required>

        <label>2. Que représente le complexe QRS ?</label>
        <input type="text" name="q2" required>

        <label>3. Que représente l'onde T ?</label>
        <input type="text" name="q3" required>

        <label>4. Quelle est la signification de l'intervalle PR ?</label>
        <input type="text" name="q4" required>

        <label>5. Qu'est-ce que le segment ST et pourquoi est-il important ?</label>
        <input type="text" name="q5" required>

        <h2>Simulation de placement des électrodes ECG</h2>
        <p>Glissez-déposez les électrodes aux emplacements corrects en suivant les codes couleurs standards. Les pastilles sont petites pour un placement précis, et l'image est agrandie.</p>
        <ul>
            <li>RA (rouge)</li>
            <li>LA (jaune)</li>
            <li>RL (noir)</li>
            <li>LL (vert)</li>
            <li>V1 (rouge)</li>
            <li>V2 (jaune)</li>
            <li>V3 (vert)</li>
            <li>V4 (brun)</li>
            <li>V5 (noir)</li>
            <li>V6 (violet)</li>
            <li>V7 (orange)</li>
            <li>V8 (blanc)</li>
            <li>V9 (gris)</li>
        </ul>

        <div id="container">
            <div id="electrodes">
                <div class="electrode" id="ra" draggable="true">RA</div>
                <div class="electrode" id="la" draggable="true">LA</div>
                <div class="electrode" id="rl" draggable="true">RL</div>
                <div class="electrode" id="ll" draggable="true">LL</div>
                <div class="electrode" id="v1" draggable="true">V1</div>
                <div class="electrode" id="v2" draggable="true">V2</div>
                <div class="electrode" id="v3" draggable="true">V3</div>
                <div class="electrode" id="v4" draggable="true">V4</div>
                <div class="electrode" id="v5" draggable="true">V5</div>
                <div class="electrode" id="v6" draggable="true">V6</div>
                <div class="electrode" id="v7" draggable="true">V7</div>
                <div class="electrode" id="v8" draggable="true">V8</div>
                <div class="electrode" id="v9" draggable="true">V9</div>
            </div>

            <div id="mannequin-container" ondrop="drop(event)" ondragover="allowDrop(event)">
                <img src="https://i.imgur.com/n6aXhGW.jpeg" id="mannequin" alt="Mannequin ECG antérieur / postérieur">
            </div>
        </div>

        <button type="submit">Envoyer la formation</button>
    </form>

    <script>
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text");
            const electrode = document.getElementById(data);
            if (!electrode) return;

            const container = document.getElementById('mannequin-container');
            const rect = container.getBoundingClientRect();
            const x = ev.clientX - rect.left - (electrode.offsetWidth / 2);
            const y = ev.clientY - rect.top - (electrode.offsetHeight / 2);

            electrode.style.position = 'absolute';
            electrode.style.left = Math.max(0, x) + 'px';
            electrode.style.top  = Math.max(0, y) + 'px';
            electrode.style.margin = '0';

            container.appendChild(electrode);
        }

        const electrodes = document.getElementsByClassName('electrode');
        for (let el of electrodes) {
            el.addEventListener('dragstart', drag);
        }

        document.getElementById('ecgForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = {};
            const inputs = this.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                formData[input.name] = input.value.trim();
            });

            formData.placements = {};
            const containerWidth = document.getElementById('mannequin-container').offsetWidth;
            const containerHeight = document.getElementById('mannequin-container').offsetHeight;
            for (let el of electrodes) {
                if (el.style.position === 'absolute') {
                    const left = parseFloat(el.style.left) || 0;
                    const top = parseFloat(el.style.top) || 0;
                    formData.placements[el.id] = {
                        leftPercent: (left / containerWidth) * 100,
                        topPercent: (top / containerHeight) * 100
                    };
                }
            }

            const submissions = JSON.parse(localStorage.getItem('ecgSubmissions') || '[]');
            submissions.push({
                timestamp: new Date().toISOString(),
                data: formData
            });
            localStorage.setItem('ecgSubmissions', JSON.stringify(submissions));

            alert('Réponse envoyé ! Merci de patientez la réponse du formateur');
            this.reset();

            const sidebar = document.getElementById('electrodes');
            for (let el of electrodes) {
                el.style.position = '';
                el.style.left = '';
                el.style.top = '';
                sidebar.appendChild(el);
            }
        });
    </script>
</body>
</html>
